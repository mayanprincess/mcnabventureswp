{# Multimedia Component - Photo Gallery (Masonry) & Video Gallery (Grid) #}
{# Data:
  - title: string
  - tabs: [{ name: string, gallery_type: 'gallery'|'videos', gallery?: [], videos?: [] }]
#}

<section class="multimedia" data-multimedia>
  <div class="multimedia__inner">
    {# Header: Title + Tabs #}
    <div class="multimedia__header">
      {% if title %}
        <h2 class="multimedia__title">{{ title }}</h2>
      {% endif %}

      {% set tab_list = tabs ?? [] %}

      {% if tab_list|length > 1 %}
        {# Tab Navigation (Pills style) #}
        <div class="multimedia__tab-list" role="tablist" aria-label="Content type">
          {% for tab in tab_list %}
            <button
              class="multimedia__tab {% if loop.first %}is-active{% endif %}"
              type="button"
              data-tab-index="{{ loop.index0 }}"
              role="tab"
              aria-selected="{{ loop.first ? 'true' : 'false' }}"
            >
              {{ tab.name }}
            </button>
          {% endfor %}
        </div>
      {% endif %}
    </div>

    {# Content Panels #}
    {% if tab_list|length > 0 %}
      {% for tab in tab_list %}
        {% if tab.gallery_type == 'gallery' and tab.gallery %}
          {# Photo Gallery - Masonry Layout #}
          <div class="multimedia__gallery {% if loop.first %}is-active{% endif %}" data-gallery="{{ loop.index0 }}" role="tabpanel">
            {% for image in tab.gallery %}
              {% set img_url = image.url ?? image %}
              {% set img_alt = image.alt ?? 'Gallery image' %}

              <div class="multimedia__masonry-item multimedia__masonry-item--{{ loop.index0 % 8 }}">
                <img
                  src="{{ img_url }}"
                  alt="{{ img_alt|e }}"
                  class="multimedia__image"
                  loading="lazy"
                  decoding="async"
                >
              </div>
            {% endfor %}
          </div>

        {% elseif tab.gallery_type == 'videos' and tab.videos %}
          {# Video Gallery - Simple Grid #}
          <div class="multimedia__videos {% if loop.first %}is-active{% endif %}" data-gallery="{{ loop.index0 }}" role="tabpanel">
            {% for video in tab.videos %}
              {% set v_url = video.video_url ?? '' %}
              {% set v_title = video.video_title ?? 'Video' %}

              {% if v_url %}
                <div class="multimedia__video-item">
                  <div class="multimedia__video-container">
                    <video
                      class="multimedia__video"
                      controls
                      preload="metadata"
                    >
                      <source src="{{ v_url }}" type="video/mp4">
                      Tu navegador no soporta videos HTML5.
                    </video>
                  </div>
                  {% if v_title %}
                    <h4 class="multimedia__video-title">{{ v_title }}</h4>
                  {% endif %}
                </div>
              {% endif %}
            {% endfor %}
          </div>

        {% else %}
          <div class="multimedia__empty {% if loop.first %}is-active{% endif %}" role="tabpanel">
            <p>No content available for this tab.</p>
          </div>
        {% endif %}
      {% endfor %}
    {% else %}
      <div class="multimedia__empty is-active">
        <p>No multimedia content configured.</p>
      </div>
    {% endif %}
  </div>
</section>
